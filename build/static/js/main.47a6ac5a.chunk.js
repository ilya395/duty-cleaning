(this["webpackJsonpduty-cleaning-app"]=this["webpackJsonpduty-cleaning-app"]||[]).push([[0],{181:function(e,t,a){e.exports=a(332)},186:function(e,t,a){},187:function(e,t,a){},188:function(e,t,a){},189:function(e,t,a){},210:function(e,t,a){},232:function(e,t,a){},257:function(e,t,a){},332:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(6),o=a.n(r),l=(a(186),a(37)),i=(a(187),a(86)),u=a(34),s=a(128),m=a.n(s),f=a(99),d=a(154),h=(a(188),a(338)),b=a(334),v=(a(189),a(135)),p=a(24),g=a.n(p);g.a.locale("ru",{weekdays:["\u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0412\u0442\u043e\u0440\u043d\u0438\u043a","\u0421\u0440\u0435\u0434\u0430","\u0427\u0435\u0442\u0432\u0435\u0440\u0433","\u041f\u044f\u0442\u043d\u0438\u0446\u0430","\u0421\u0443\u0431\u0431\u043e\u0442\u0430"],week:{dow:1,doy:1}});var E=Object(v.b)(g.a),O=[{title:"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u043e\u0440\u044b",start:g()([2020,8,9]),end:g()([2020,8,9]),allDay:!0}],j=function(e){return c.a.createElement("div",{className:"calendar-container"},c.a.createElement(v.a,{localizer:E,events:e.events||O,startAccessor:"start",endAccessor:"end",views:{month:!0},onSelectEvent:function(t){return function(t){e.clickOnDay(t)}(t)}}))},y=a(69),w=function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement(y.a,{type:"primary",danger:!0,onClick:e.logoutPlz},"\u0412\u044b\u043a\u0430\u0442\u0438\u0442\u044c\u0441\u044f"))},I=function(e){for(var t=e.data,a=e.today,n=e.mutations,c=g()(a).daysInMonth(),r=g()(a).format("YYYY"),o=g()(a).format("M")-1,l=[],i=0,u=function(e){var a={title:"",start:g()([r,o,e+1]),end:g()([r,o,e+1]),allDay:!0};if(6!==g()([r,o,e+1]).isoWeekday()&&7!==g()([r,o,e+1]).isoWeekday()&&0!==g()([r,o,e+1]).isoWeekday()){if(i++,n[e]){var c=t.findIndex((function(t){return t.id===n[e]}));i=c+1}i>t.length&&(i=1);var u={};u=n[e]?t.find((function(t){return t.id===n[e]})):t[i-1],a.title=u.title,a.eventId=u.id}else a.title="\u0412\u044b\u0445\u043e\u0434\u043d\u043e\u0439",a.eventId=99;l.push(a)},s=0;s<c;s++)u(s);return l},S=(a(210),a(336)),k=a(337),Y=S.a.Option,D=function(e){var t=Object(n.useState)(!1),a=Object(l.a)(t,2),r=a[0],o=a[1];Object(n.useEffect)((function(){"\u0412\u044b\u0445\u043e\u0434\u043d\u043e\u0439"===e.eventName?o(!0):o(!1);var t=+g()(e.today).format("D"),a=+g()(e.date).format("D");o(a<t)}),[e.eventName,e.today,e.date]);var i=function(){e.changeVisible(!e.visible)};return c.a.createElement(k.a,{title:"\u0425\u043e\u0447\u0435\u0448\u044c \u0441\u043a\u0430\u0437\u0430\u0442\u044c, \u0447\u0442\u043e \u043a\u0442\u043e-\u0442\u043e \u0432\u043e\u0432\u0440\u0435\u043c\u044f \u043d\u0435 \u0443\u0431\u0440\u0430\u043b\u0441\u044f?",visible:e.visible,onOk:i,onCancel:i},c.a.createElement("p",null,"\u0414\u0430\u0442\u0430: ",g()(e.date).format("DD MM YYYY")),c.a.createElement("p",null,"\u0414\u0435\u0436\u0443\u0440\u043d\u044b\u0439 \u043e\u0442\u0434\u0435\u043b: ","\u0412\u044b\u0445\u043e\u0434\u043d\u043e\u0439"===e.eventName?"\u041d\u0435\u0442":e.eventName),c.a.createElement("div",null,c.a.createElement(S.a,{showSearch:!0,style:{width:200},placeholder:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0436\u0443\u0440\u043d\u043e\u0433\u043e",optionFilterProp:"children",onChange:function(t){e.changeNewEventId(+t,g()(e.date))},onFocus:function(){console.log("focus")},onBlur:function(){console.log("blur")},onSearch:function(e){console.log("search:",e)},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},disabled:r},e.data.map((function(e){return c.a.createElement(Y,{key:e.id,value:e.id},e.title)})))))},N=c.a.createContext(null),C=a(340),x=a(333),M=(a(232),function(){return c.a.createElement("div",{className:"work-area preloader"},c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"preloader-wrapper big active"},c.a.createElement(C.b,{size:"middle"},c.a.createElement(x.a,{size:"large"})))))}),P=h.a.Header,F=h.a.Content,z=h.a.Footer,A=b.a.Title,W=[{title:"\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445",id:999}],R=function(e){var t=Object(n.useState)(!0),a=Object(l.a)(t,2),r=a[0],o=a[1];Object(n.useEffect)((function(){return o(!1)}),[]);var u=Object(n.useState)(W),s=Object(l.a)(u,2),b=s[0],v=s[1],p=Object(n.useState)(0),E=Object(l.a)(p,2),O=E[0],y=E[1],S=Object(n.useState)({}),k=Object(l.a)(S,2),Y=k[0],C=k[1],x=Object(n.useState)([]),R=Object(l.a)(x,2),V=R[0],_=R[1],B=Object(n.useState)(!1),q=Object(l.a)(B,2),J=q[0],L=q[1],U=Object(n.useState)(0),G=Object(l.a)(U,2),H=G[0],T=G[1],K=Object(n.useState)(0),X=Object(l.a)(K,2),Z=X[0],$=X[1],Q=Object(n.useState)(""),ee=Object(l.a)(Q,2),te=ee[0],ae=ee[1],ne=Object(n.useContext)(N),ce=ne.getDepartmentsRef,re=ne.getMutationsRef,oe=ne.auth;Object(n.useEffect)((function(){ce().once("value").then((function(e){var t=e.val(),a=[];return t.forEach((function(e){a.push(e)})),a})).then((function(e){v(e),console.log("\u0432\u0437\u044f\u043b\u0438 data \u0438\u0437 \u0431\u0430\u0437\u044b")})).catch((function(e){console.log(e.message)}))}),[ce]),Object(n.useEffect)((function(){y(new Date)}),[]),Object(n.useEffect)((function(){var e={};re({year:g()(O).format("YYYY"),month:g()(O).format("M")}).once("value").then((function(t){for(var a in t.val())e[a]=t.val()[a]})).then((function(){C(e)})).catch((function(e){return console.log(e.message)}))}),[O,re]),Object(n.useEffect)((function(){_((function(){return I({data:b,today:O,mutations:Y})}))}),[O,b,Y]);var le=function(){var e=Object(d.a)(m.a.mark((function e(t,a){var n,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=+g()(a).format("D")-1,C((function(e){return Object(i.a)(Object(i.a)({},e),{},Object(f.a)({},n,t))})),c={},e.next=5,re({year:g()(a).format("YYYY"),month:g()(a).format("M")}).once("value").then((function(e){e.val().forEach((function(e,t){c[t]=e}))})).then((function(){c[n]=t})).catch((function(e){return console.log(e.message)}));case 5:return e.next=7,re({year:g()(a).format("YYYY"),month:g()(a).format("M")}).set(c).catch((function(e){return console.log(e.message)}));case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return r?c.a.createElement(M,null):c.a.createElement(c.a.Fragment,null,c.a.createElement(h.a,{className:"layout main-layout main-layout_all-height"},c.a.createElement(P,{className:"header-block"},c.a.createElement(A,{level:1,className:"header-block__title-page"},"\u0420\u0430\u0441\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0434\u0435\u0436\u0443\u0440\u0441\u0442\u0432"),c.a.createElement(w,{logoutPlz:function(){console.log("\u043e\u043a, logout"),oe.signOut(),localStorage.removeItem("userId"),e.history.push("/auth")}})),c.a.createElement(F,{style:{padding:"0 50px"}},c.a.createElement("div",{className:"site-layout-content main-container"},c.a.createElement(j,{events:V,clickOnDay:function(e){L(!J),T(e.end),$(e.eventId),ae(e.title)}}))),c.a.createElement(z,{style:{textAlign:"center"}},"Duty Cleaing \xa92020 Created by DVM Group")),c.a.createElement(D,{date:H,data:b,visible:J,changeVisible:L,eventId:Z,eventName:te,changeNewEventId:le,today:O}))},V=(a(257),a(335)),_=a(339),B={labelCol:{span:8},wrapperCol:{span:16}},q={wrapperCol:{offset:8,span:16}},J=function(e){console.log("#### props in Auth: ",e,e.history);var t=Object(n.useState)(!0),a=Object(l.a)(t,2),r=a[0],o=a[1];Object(n.useEffect)((function(){return o(!1)}),[]);var i=Object(n.useState)(null),u=Object(l.a)(i,2),s=u[0],m=u[1];Object(n.useEffect)((function(){var t=e.history;m(t)}),[e]);var f=Object(n.useState)(!1),d=Object(l.a)(f,2),h=d[0],b=d[1],v=Object(n.useContext)(N).signWithEmail;Object(n.useEffect)((function(){!0===h&&s.push("/main")}),[h,s]);return r?c.a.createElement(M,null):c.a.createElement("div",{className:"form-wrap"},c.a.createElement(V.a,Object.assign({},B,{name:"basic",initialValues:{remember:!0},onFinish:function(e){var t=e.email,a=e.password;v(t,a).then((function(e){console.log("Success!"),b(!0),localStorage.setItem("userId",e.user.uid),s.push("/main")})).catch((function(){console.log("\u043a\u0442\u043e \u0442\u044b \u0442\u0432\u0430\u0440\u044c?"),b(!1)}))},onFinishFailed:function(e){console.log("Failed:",e)},className:"form"}),c.a.createElement(V.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your email!"}]},c.a.createElement(_.a,null)),c.a.createElement(V.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},c.a.createElement(_.a.Password,null)),c.a.createElement(V.a.Item,q,c.a.createElement(y.a,{type:"primary",htmlType:"submit"},"\u0412\u043a\u0430\u0442\u0438\u0442\u044c\u0441\u044f"))))},L=c.a.createContext(null),U=a(180),G=function(e){var t=e.component,a=Object(U.a)(e,["component"]);return c.a.createElement(u.b,Object.assign({},a,{render:function(e){return localStorage.getItem("userId")?c.a.createElement(t,e):c.a.createElement(u.a,{to:"/auth"})}}))},H=function(e){return c.a.createElement(u.d,null,c.a.createElement(G,{path:"/main",component:R}),c.a.createElement(u.b,{path:"/auth",render:function(e){return c.a.createElement(L.Provider,{value:Object(i.a)({},e)},c.a.createElement(J,e))}}),c.a.createElement(u.a,{to:"/auth"}))},T=a(98);var K=function(){var e=Object(n.useState)(!0),t=Object(l.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(!1),i=Object(l.a)(o,2),u=i[0],s=i[1],m=Object(n.useContext)(N).auth;Object(n.useEffect)((function(){localStorage.getItem("userId")?(console.log("we know who are you!"),m.onAuthStateChanged((function(e){r(!1),e?(s(e.uid),localStorage.setItem("userId",JSON.stringify(e.uid))):(s(!1),localStorage.removeItem("userId"))}))):(console.log("we don`t know who are you!"),s(!1),r(!1))}),[u,m]);var f=H(u);return a?c.a.createElement(M,null):c.a.createElement(c.a.Fragment,null,c.a.createElement(T.a,null,f))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var X=a(174),Z=a(117),$=(a(328),a(330),{apiKey:"AIzaSyD_M2f-8PYDneZIuszXVtUGdYdfH7_9Dxk",authDomain:"duty-cleaning.firebaseapp.com",databaseURL:"https://duty-cleaning.firebaseio.com",projectId:"duty-cleaning",storageBucket:"duty-cleaning.appspot.com",messagingSenderId:"814671668344",appId:"1:814671668344:web:e7a3f3cd403a25e55e798d"}),Q=function e(){var t=this;Object(X.a)(this,e),this.signWithEmail=function(e,a){return t.auth.signInWithEmailAndPassword(e,a)},this.getDepartmentsRef=function(){return t.database.ref("/departments/")},this.getMutationsRef=function(e){var a=e.year,n=e.month;return t.database.ref("/mutations/".concat(a,"/").concat(n,"/"))},this.requestRef=function(e){return t.database.ref(e)},Z.initializeApp($),this.auth=Z.auth(),this.database=Z.database(),this.userUid=null};o.a.render(c.a.createElement(N.Provider,{value:new Q},c.a.createElement(K,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[181,1,2]]]);
//# sourceMappingURL=main.47a6ac5a.chunk.js.map