(this["webpackJsonpduty-cleaning-app"]=this["webpackJsonpduty-cleaning-app"]||[]).push([[0],{171:function(e,t,a){e.exports=a(313)},176:function(e,t,a){},177:function(e,t,a){},178:function(e,t,a){},179:function(e,t,a){},200:function(e,t,a){},222:function(e,t,a){},234:function(e,t,a){},313:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(8),o=a.n(c),l=(a(176),a(37)),i=(a(177),a(78)),u=a(33),s=a(116),m=a.n(s),f=a(93),d=a(145),h=(a(178),a(315)),b=a(317),v=(a(179),a(124)),E=a(27),g=a.n(E);g.a.locale("ru",{weekdays:["\u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0412\u0442\u043e\u0440\u043d\u0438\u043a","\u0421\u0440\u0435\u0434\u0430","\u0427\u0435\u0442\u0432\u0435\u0440\u0433","\u041f\u044f\u0442\u043d\u0438\u0446\u0430","\u0421\u0443\u0431\u0431\u043e\u0442\u0430"],week:{dow:1,doy:1}});var p=Object(v.b)(g.a),O=[{title:"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u043e\u0440\u044b",start:g()([2020,8,9]),end:g()([2020,8,9]),allDay:!0}],y=function(e){return r.a.createElement("div",{className:"calendar-container"},r.a.createElement(v.a,{localizer:p,events:e.events||O,startAccessor:"start",endAccessor:"end",views:{month:!0},onSelectEvent:function(t){return function(t){e.clickOnDay(t)}(t)}}))},j=a(64),w=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{type:"primary",danger:!0,onClick:e.logoutPlz},"\u0412\u044b\u043a\u0430\u0442\u0438\u0442\u044c\u0441\u044f"))},I=function(e){for(var t=e.data,a=e.today,n=e.mutations,r=g()(a).daysInMonth(),c=g()(a).format("YYYY"),o=g()(a).format("M")-1,l=[],i=0,u=function(e){var a={title:"",start:g()([c,o,e+1]),end:g()([c,o,e+1]),allDay:!0};if(6!==g()([c,o,e+1]).isoWeekday()&&7!==g()([c,o,e+1]).isoWeekday()&&0!==g()([c,o,e+1]).isoWeekday()){if(i++,n[e]){var r=t.findIndex((function(t){return t.id===n[e]}));i=r+1}i>t.length&&(i=1);var u={};u=n[e]?t.find((function(t){return t.id===n[e]})):t[i-1],a.title=u.title,a.eventId=u.id}else a.title="\u0412\u044b\u0445\u043e\u0434\u043d\u043e\u0439",a.eventId=99;l.push(a)},s=0;s<r;s++)u(s);return l},S=(a(200),a(318)),k=a(319),Y=S.a.Option,D=function(e){var t=Object(n.useState)(!1),a=Object(l.a)(t,2),c=a[0],o=a[1];Object(n.useEffect)((function(){"\u0412\u044b\u0445\u043e\u0434\u043d\u043e\u0439"===e.eventName?o(!0):o(!1);var t=+g()(e.today).format("D"),a=+g()(e.date).format("D");o(a<t)}),[e.eventName,e.today,e.date]);var i=function(){e.changeVisible(!e.visible)};return r.a.createElement(k.a,{title:"\u0425\u043e\u0447\u0435\u0448\u044c \u0441\u043a\u0430\u0437\u0430\u0442\u044c, \u0447\u0442\u043e \u043a\u0442\u043e-\u0442\u043e \u0432\u043e\u0432\u0440\u0435\u043c\u044f \u043d\u0435 \u0443\u0431\u0440\u0430\u043b\u0441\u044f?",visible:e.visible,onOk:i,onCancel:i},r.a.createElement("p",null,"\u0414\u0430\u0442\u0430: ",g()(e.date).format("DD MM YYYY")),r.a.createElement("p",null,"\u0414\u0435\u0436\u0443\u0440\u043d\u044b\u0439 \u043e\u0442\u0434\u0435\u043b: ","\u0412\u044b\u0445\u043e\u0434\u043d\u043e\u0439"===e.eventName?"\u041d\u0435\u0442":e.eventName),r.a.createElement("div",null,r.a.createElement(S.a,{showSearch:!0,style:{width:200},placeholder:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0436\u0443\u0440\u043d\u043e\u0433\u043e",optionFilterProp:"children",onChange:function(t){e.changeNewEventId(+t,g()(e.date))},onFocus:function(){console.log("focus")},onBlur:function(){console.log("blur")},onSearch:function(e){console.log("search:",e)},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},disabled:c},e.data.map((function(e){return r.a.createElement(Y,{key:e.id,value:e.id},e.title)})))))},C=r.a.createContext(null),N=a(321),x=a(314),P=(a(222),function(){return r.a.createElement("div",{className:"work-area preloader"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"preloader-wrapper big active"},r.a.createElement(N.b,{size:"middle"},r.a.createElement(x.a,{size:"large"})))))}),M=h.a.Header,F=h.a.Content,z=h.a.Footer,A=[{title:"\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445",id:999}],W=function(e){var t=Object(n.useState)(!0),a=Object(l.a)(t,2),c=a[0],o=a[1];Object(n.useEffect)((function(){return o(!1)}),[]);var u=Object(n.useState)(A),s=Object(l.a)(u,2),v=s[0],E=s[1],p=Object(n.useState)(0),O=Object(l.a)(p,2),j=O[0],S=O[1],k=Object(n.useState)({}),Y=Object(l.a)(k,2),N=Y[0],x=Y[1],W=Object(n.useState)([]),R=Object(l.a)(W,2),V=R[0],B=R[1],q=Object(n.useState)(!1),J=Object(l.a)(q,2),L=J[0],U=J[1],_=Object(n.useState)(0),G=Object(l.a)(_,2),H=G[0],K=G[1],T=Object(n.useState)(0),X=Object(l.a)(T,2),Z=X[0],$=X[1],Q=Object(n.useState)(""),ee=Object(l.a)(Q,2),te=ee[0],ae=ee[1],ne=Object(n.useContext)(C),re=ne.getDepartmentsRef,ce=ne.getMutationsRef,oe=ne.auth;Object(n.useEffect)((function(){re().once("value").then((function(e){var t=e.val(),a=[];return t.forEach((function(e){a.push(e)})),a})).then((function(e){E(e),console.log("\u0432\u0437\u044f\u043b\u0438 data \u0438\u0437 \u0431\u0430\u0437\u044b")})).catch((function(e){console.log(e.message)}))}),[re]),Object(n.useEffect)((function(){S(new Date)}),[]),Object(n.useEffect)((function(){var e={};ce({year:g()(j).format("YYYY"),month:g()(j).format("M")}).once("value").then((function(t){for(var a in t.val())e[a]=t.val()[a]})).then((function(){x(e)})).catch((function(e){return console.log(e.message)}))}),[j,ce]),Object(n.useEffect)((function(){B((function(){return I({data:v,today:j,mutations:N})}))}),[j,v,N]);var le=function(){var e=Object(d.a)(m.a.mark((function e(t,a){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=+g()(a).format("D")-1,x((function(e){return Object(i.a)(Object(i.a)({},e),{},Object(f.a)({},n,t))})),r={},e.next=5,ce({year:g()(a).format("YYYY"),month:g()(a).format("M")}).once("value").then((function(e){e.val().forEach((function(e,t){r[t]=e}))})).then((function(){r[n]=t})).catch((function(e){return console.log(e.message)}));case 5:return e.next=7,ce({year:g()(a).format("YYYY"),month:g()(a).format("M")}).set(r).catch((function(e){return console.log(e.message)}));case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return c?r.a.createElement(P,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{className:"layout main-layout main-layout_all-height"},r.a.createElement(M,null,r.a.createElement("div",{className:"logo"}),r.a.createElement(b.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["2"]},r.a.createElement(b.a.Item,{key:"1"},"nav 1"),r.a.createElement(b.a.Item,{key:"2"},"nav 2"),r.a.createElement(b.a.Item,{key:"3"},"nav 3")),r.a.createElement(w,{logoutPlz:function(){console.log("\u043e\u043a, logout"),oe.signOut(),localStorage.removeItem("userId"),e.history.push("/auth")}})),r.a.createElement(F,{style:{padding:"0 50px"}},r.a.createElement("div",{className:"site-layout-content main-container"},r.a.createElement(y,{events:V,clickOnDay:function(e){U(!L),K(e.end),$(e.eventId),ae(e.title)}}))),r.a.createElement(z,{style:{textAlign:"center"}},"Duty Cleaing \xa92020 Created by DVM Group")),r.a.createElement(D,{date:H,data:v,visible:L,changeVisible:U,eventId:Z,eventName:te,changeNewEventId:le,today:j}))},R=(a(234),a(316)),V=a(320),B={labelCol:{span:8},wrapperCol:{span:16}},q={wrapperCol:{offset:8,span:16}},J=function(e){console.log("#### props in Auth: ",e,e.history);var t=Object(n.useState)(!0),a=Object(l.a)(t,2),c=a[0],o=a[1];Object(n.useEffect)((function(){return o(!1)}),[]);var i=Object(n.useState)(null),u=Object(l.a)(i,2),s=u[0],m=u[1];Object(n.useEffect)((function(){var t=e.history;m(t)}),[e]);var f=Object(n.useState)(!1),d=Object(l.a)(f,2),h=d[0],b=d[1],v=Object(n.useContext)(C).signWithEmail;Object(n.useEffect)((function(){!0===h&&s.push("/main")}),[h,s]);return c?r.a.createElement(P,null):r.a.createElement("div",{className:"form-wrap"},r.a.createElement(R.a,Object.assign({},B,{name:"basic",initialValues:{remember:!0},onFinish:function(e){var t=e.email,a=e.password;v(t,a).then((function(e){console.log("Success!"),b(!0),localStorage.setItem("userId",e.user.uid),s.push("/main")})).catch((function(){console.log("\u043a\u0442\u043e \u0442\u044b \u0442\u0432\u0430\u0440\u044c?"),b(!1)}))},onFinishFailed:function(e){console.log("Failed:",e)},className:"form"}),r.a.createElement(R.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your email!"}]},r.a.createElement(V.a,null)),r.a.createElement(R.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(V.a.Password,null)),r.a.createElement(R.a.Item,q,r.a.createElement(j.a,{type:"primary",htmlType:"submit"},"\u0412\u043a\u0430\u0442\u0438\u0442\u044c\u0441\u044f"))))},L=r.a.createContext(null),U=function(e){return console.log(e),e?r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/main",render:function(e){return r.a.createElement(L.Provider,{value:Object(i.a)({},e)},r.a.createElement(W,e))}}),r.a.createElement(u.a,{to:"/main"})):r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/auth",render:function(e){return r.a.createElement(L.Provider,{value:Object(i.a)({},e)},r.a.createElement(J,e))}}),r.a.createElement(u.a,{to:"/auth"}))},_=a(115);var G=function(){var e=Object(n.useState)(!0),t=Object(l.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),i=Object(l.a)(o,2),u=i[0],s=i[1],m=Object(n.useContext)(C).auth;Object(n.useEffect)((function(){localStorage.getItem("userId")?(console.log("we know who are you!"),m.onAuthStateChanged((function(e){c(!1),e?(s(e.uid),localStorage.setItem("userId",JSON.stringify(e.uid))):(s(!1),localStorage.removeItem("userId"))}))):(console.log("we don`t know who are you!"),s(!1),c(!1))}),[u,m]);var f=U(u);return a?r.a.createElement(P,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,null,f))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var H=a(165),K=a(104),T=(a(309),a(311),{apiKey:"AIzaSyD_M2f-8PYDneZIuszXVtUGdYdfH7_9Dxk",authDomain:"duty-cleaning.firebaseapp.com",databaseURL:"https://duty-cleaning.firebaseio.com",projectId:"duty-cleaning",storageBucket:"duty-cleaning.appspot.com",messagingSenderId:"814671668344",appId:"1:814671668344:web:e7a3f3cd403a25e55e798d"}),X=function e(){var t=this;Object(H.a)(this,e),this.signWithEmail=function(e,a){return t.auth.signInWithEmailAndPassword(e,a)},this.getDepartmentsRef=function(){return t.database.ref("/departments/")},this.getMutationsRef=function(e){var a=e.year,n=e.month;return t.database.ref("/mutations/".concat(a,"/").concat(n,"/"))},this.requestRef=function(e){return t.database.ref(e)},K.initializeApp(T),this.auth=K.auth(),this.database=K.database(),this.userUid=null};o.a.render(r.a.createElement(C.Provider,{value:new X},r.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[171,1,2]]]);
//# sourceMappingURL=main.8ea0e337.chunk.js.map